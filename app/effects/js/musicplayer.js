function song(a){this.index=new Number(a.index),this.name=a.name,this.singer=a.singer,this.album=a.album,this.cover=a.cover,this.src=a.src,this.length=a.length,this.lyric=a.lyric}function musicPlayer(a){this.auo=$("auo"),this.song=null,this.ps=a,this.order="normal",this.volume=50}function playerStyle(){}function addEvent(){var a=$("cplay"),b=a.getElementsByTagName("a");addEventHanlder(b[0],"click",function(){GLOBAL.musicPlayer.run(GLOBAL.musicPlayer,"forward")}),addEventHanlder(b[1],"click",function(){GLOBAL.musicPlayer.run(GLOBAL.musicPlayer,"play")}),addEventHanlder(b[2],"click",function(){GLOBAL.musicPlayer.run(GLOBAL.musicPlayer,"back")}),addEventHanlder(GLOBAL.musicPlayer.auo,"canplay",function(){GLOBAL.musicPlayer.song.length=Math.round(GLOBAL.musicPlayer.auo.duration),GLOBAL.musicPlayer.ps.loadSong(GLOBAL.musicPlayer.song)}),addEventHanlder(GLOBAL.musicPlayer.auo,"ended",function(){GLOBAL.musicPlayer.run(GLOBAL.musicPlayer,"autoPlay")}),addEventHanlder(GLOBAL.musicPlayer.auo,"progress",GLOBAL.musicPlayer.ps.preLoad),addEventHanlder($("setVolume"),"click",function(a){a.stopPropagation(),"block"===GLOBAL.getStyle($("volumeTrip"),"display")?GLOBAL.musicPlayer.ps.toggleVolumeTrip("none"):GLOBAL.musicPlayer.ps.toggleVolumeTrip("block")}),addEventHanlder($("volumeTrip"),"click",GLOBAL.musicPlayer.setVolume),addEventHanlder($("slipButton"),"mousedown",function(){GLOBAL.upTarget="volume",addEventHanlder($("plr"),"mousemove",GLOBAL.musicPlayer.setVolume)}),addEventHanlder($("statBarW"),"click",function(a){GLOBAL.musicPlayer.location(a)}),addEventHanlder($("curDot"),"mousedown",function(){GLOBAL.upTarget="song",addEventHanlder($("plr"),"mousemove",GLOBAL.musicPlayer.location)}),addEventHanlder(document.body,"mouseup",function(){GLOBAL.upTarget&&("song"===GLOBAL.upTarget?(GLOBAL.musicPlayer.locateAudio(),removeEventHandler($("plr"),"mousemove",GLOBAL.musicPlayer.location)):"volume"===GLOBAL.upTarget&&removeEventHandler($("plr"),"mousemove",GLOBAL.musicPlayer.setVolume),GLOBAL.upTarget=null)}),addEventHanlder($("plr"),"selectstart",function(){return!1})}function play_pause_event(a){addEventHanlder(GLOBAL.playButton,"click",function(){GLOBAL.musicPlayer.run(GLOBAL.musicPlayer,a)})}function hidePlayerAll(a){a.preventDefault();var b=a.currentTarget,c=b.className.split(" ");"lock_bg"===c[1]?(c[1]="unlock_bg",b.className=c.join(" "),hidePlayer(),GLOBAL.ePlayer.onmouseover=showPlayer,GLOBAL.ePlayer.onmouseout=hidePlayer):(c[1]="lock_bg",b.className=c.join(" "),showPlayer(),GLOBAL.ePlayer.onmouseover=null,GLOBAL.ePlayer.onmouseout=null)}function hidePlayer(){GLOBAL.ePlayer.style.bottom="-46px",document.getElementById("plw").style.bottom="-46px"}function showPlayer(){GLOBAL.ePlayer.style.bottom="0",document.getElementById("plw").style.bottom="0"}var songs=[{index:"0",name:"new soul",singer:"Vox Angeli",album:"经典流行",cover:"../img/cover/player_cover.jpg",src:"http://link.hhtjim.com/163/19711382.mp3",length:"",lyric:""},{index:"1",name:"断点",singer:"张敬轩",album:"经典流行",cover:"../img/cover/player_cover.jpg",src:"http://link.hhtjim.com/163/189236.mp3",length:"",lyric:""},{index:"2",name:"The Saltwater Room",singer:"Owl City",album:"经典流行",cover:"../img/cover/player_cover.jpg",src:"http://link.hhtjim.com/163/1807865.mp3",length:"",lyric:""},{index:"3",name:"模特",singer:"李荣浩",album:"经典流行",cover:"../img/cover/player_cover.jpg",src:"http://link.hhtjim.com/163/27731176.mp3",length:"",lyric:""},{index:"4",name:"月亮偷着哭",singer:"何静",album:"经典流行",cover:"../img/cover/player_cover.jpg",src:"http://link.hhtjim.com/163/245398.mp3",length:"",lyric:""}],$=function(a){return document.getElementById(a)};musicPlayer.prototype.load=function(a){this.song=a,this.auo.src=a.src},musicPlayer.prototype.getSong=function(a,b){var c,d=Number(this.song.index);return b&&"normal"!==b?"repeat"===b?c=d:"random"===b&&(c=GLOBAL.getRandom(0,songs.length)):c=a>0?d===songs.length-1?0:d+1:0===d?songs.length-1:d-1,c},musicPlayer.prototype.play=function(){this.auo.play(),this.ps.play_pause("play"),play_pause_event("pause"),GLOBAL.playInterval=setInterval(GLOBAL.musicPlayer.ps.playTime,1e3)},musicPlayer.prototype.pause=function(){this.auo.pause(),this.ps.play_pause("pause"),play_pause_event("play"),clearInterval(GLOBAL.playInterval)},musicPlayer.prototype.forward=function(){var a=this.getSong(-1);this.load(songs[a]),this.play()},musicPlayer.prototype.back=function(){var a=this.getSong(1);this.load(songs[a]),this.play()},musicPlayer.prototype.autoPlay=function(){clearInterval(GLOBAL.playInterval);var a=this.getSong(1,this.order);this.load(songs[a]),this.play()},musicPlayer.prototype.location=function(a){GLOBAL.musicPlayer.ps.locateDot(a),GLOBAL.musicPlayer.auo.paused||"click"!=a.type||GLOBAL.musicPlayer.locateAudio()},musicPlayer.prototype.locateAudio=function(){if(!GLOBAL.musicPlayer.auo.paused){var a=$("playbackBar").offsetWidth,b=Math.ceil(a/454*GLOBAL.musicPlayer.song.length);GLOBAL.musicPlayer.auo.currentTime=b}},musicPlayer.prototype.setVolume=function(a){GLOBAL.musicPlayer.ps.setVolume(a),GLOBAL.musicPlayer.volumeValue()},musicPlayer.prototype.volumeValue=function(){var a=$("volumeValue").offsetHeight;GLOBAL.musicPlayer.auo.volume=a/92},musicPlayer.prototype.initVolume=function(a){GLOBAL.musicPlayer.auo.volume=a,GLOBAL.musicPlayer.ps.setVolume(null,a)},musicPlayer.prototype.run=function(a,b){this[b]()},playerStyle.prototype.setVolume=function(a,b){var c;c=a?$("plr").offsetTop-a.clientY-11:92*b,92>=c&&c>=0&&($("volumeValue").style.height=c+"px",$("slipButton").style.bottom=c-6+"px")},playerStyle.prototype.toggleVolumeTrip=function(a){GLOBAL.volumeTrip.style.display=a},playerStyle.prototype.prettyTime=function(a){a=Math.ceil(a);var b=Math.floor(a/60),c=10>b?"0"+b:b,d=a%60,e=10>d?"0"+d:d;return c+":"+e},playerStyle.prototype.loadSong=function(a){var b=$("songInfo"),c=b.getElementsByTagName("a");c[0].innerHTML=a.name,c[1].innerHTML=a.singer;var d=$("timeInfo"),e=GLOBAL.musicPlayer.ps.prettyTime(a.length);d.innerHTML="<em>00:00</em>/"+e;var f=$("songCover");f.style.backGround="url("+a.cover+") no-repeat",GLOBAL.timePlayed=$("timeInfo").getElementsByTagName("em")[0]},playerStyle.prototype.play_pause=function(a){var b=GLOBAL.playButton.className;"play"===a?GLOBAL.playButton.className=b.replace("play_bg","pause_bg"):GLOBAL.playButton.className=b.replace("pause_bg","play_bg")},playerStyle.prototype.playTime=function(){var a=GLOBAL.musicPlayer.auo.currentTime;if(!(Math.ceil(a)>GLOBAL.musicPlayer.song.length)){var b=GLOBAL.musicPlayer.ps.prettyTime(a);GLOBAL.timePlayed.innerHTML=b;var c=454*Math.ceil(a)/GLOBAL.musicPlayer.song.length;GLOBAL.playbackBar.style.width=c+"px",$("curDot").style.left=c-10+"px"}},playerStyle.prototype.preLoad=function(){var a=GLOBAL.musicPlayer.auo.buffered;if(a.length>0){var b=a.end(0),c=454*Math.round(b)/GLOBAL.musicPlayer.auo.duration;GLOBAL.preloadBar.style.width=c+"px"}},playerStyle.prototype.locateDot=function(a){var b=a.clientX-$("pst").offsetLeft;return 454>=b&&b>=0?(GLOBAL.playbackBar.style.width=b+"px",$("curDot").style.left=b-9+"px",b):null},function(){GLOBAL.ePlayer=document.getElementById("plr"),GLOBAL.playButton=GLOBAL.getElementsByClassName("play_bg",$("cplay"),"a")[0],GLOBAL.playbackBar=$("playbackBar"),GLOBAL.preloadBar=$("preloadbar"),GLOBAL.volumeTrip=$("volumeTrip"),document.getElementById("pll").onclick=function(a){hidePlayerAll(a)},GLOBAL.musicPlayer=new musicPlayer(new playerStyle),addEvent(),GLOBAL.musicPlayer.load(songs[0]),GLOBAL.musicPlayer.initVolume(.5)}();